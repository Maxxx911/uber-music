<%= javascript_pack_tag 'application' %>
<div class="section text-center">
  <%= form_with model: @organization do |f| %>    
    <div class="gallery">
      <img id="new-image" src="/assets/default_organization.jpg" alt="..." width="200" height="200" style="border-radius: 6px"/>
    </div>
    <div>
      <span class="btn btn-raised btn-round btn-default btn-file">
        <%= f.file_field :image, id: "gallery-photo-add", multiple: true, autocomplete: @organization.images.first %>
      </span>
    </div>
      <div class="fileinput-preview fileinput-exists thumbnail img-raised"></div>
    </div>
    <div class='container'>
      <%= f.text_field :name, class: "form-control", placeholder: 'Name'%>
      <br/>
      <%= f.text_area :description,  class: "form-control", placeholder: 'Description'%>  
    </div>
    <%= f.submit "Create", class: "btn btn-primary" %>
  <% end %>
</div>

<script>
  $(function() {
  var imagesPreview = function(input, placeToInsertImagePreview) {
    $('.gallery').empty()
    if (input.files) {
      var filesAmount = input.files.length;
      for (i = 0; i < filesAmount; i++) {
        var reader = new FileReader();
        reader.onload = function(event) {
            $($.parseHTML('<img width="200" height="200" style="border-radius: 6px">')).attr('src', event.target.result).appendTo(placeToInsertImagePreview);
        }
        reader.readAsDataURL(input.files[i]);
      }
    }
  };
  $('#gallery-photo-add').on('change', function() {
      imagesPreview(this, 'div.gallery');
  });
});
</script>
